# 异步系统无锁

####基本工具库对象，单向引用，建议用锁

比如做一个支持并发的计数器：

```go
package main

import (
	"sync"
	"sync/atomic"
)

type Counter struct {
	mut     sync.Mutex
	currNum int64
	maxNum  int64
}

// +1
func (c *Counter)AddOne() int {
	new :=atomic.AddInt64(&c.currNum,1)
	c.mut.Lock()
	if c.maxNum < new {
		c.maxNum = new
	}
	c.mut.Unlock()
	return int(c.currNum)
}
// -1
func (c *Counter) DeleteOne() int {
	return int(atomic.AddInt64(&c.currNum,-1))
}

// current
func (c *Counter) Current() int {
	return int(atomic.LoadInt64(&c.currNum))
}

//max
func (c *Counter) MaxNum() int {
	return int(atomic.LoadInt64(&c.maxNum))
}

// New
func NewCounter() *Counter {
	return &Counter{}
}

```