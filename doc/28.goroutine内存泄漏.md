# go routine 内存泄漏
原始版

```go
import (
	"time"
)

func main() {
	c := make(chan struct{})

	go func() {
	    time.Sleep(time.Second * 2)
	    c <- struct{}{}
	}()

	go func() {
	    select {
	    case <-time.After(time.Second):
	        fmt.Println("Timeout...")
	    case <-c:
	        fmt.Println("Done")
	    }
	}()

	time.Sleep(time.Second * 5)
}
```
由同步变成异步

改进版

```go
import (
"time"
)

func main() {
c := make(chan struct{}, 1)

go func() {
   time.Sleep(time.Second * 2)
   c <- struct{}{}
}()

go func() {
   select {
   case <-time.After(time.Second):
       fmt.Println("Timeout...")
   case <-c:
       fmt.Println("Done")
   }
}()

time.Sleep(time.Second * 5)
}
```